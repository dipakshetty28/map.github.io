<!-- 
<!DOCTYPE html>
<html>

<head>
    <title>Apply Edits with ArcGIS API for JavaScript</title>
    <link rel="stylesheet" href="https://js.arcgis.com/4.24/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.24/"></script>
</head>

<body>
    <div id="viewDiv" style="height: 100vh;"></div>
    <script>
        require([
            "esri/Map",
            "esri/views/MapView",
            "esri/layers/FeatureLayer",
            "esri/identity/IdentityManager",
            "esri/identity/Credential"
        ], function (Map, MapView, FeatureLayer, IdentityManager, Credential) {


            // Define the URL for the feature service
            const featureLayerUrl = 'https://gistest.twdb.texas.gov/server/rest/services/TxGIO_GIT/Dipak_Test_Collection_Rating/FeatureServer/0';
            // Create a FeatureLayer instance
            const featureLayer = new FeatureLayer({ url: featureLayerUrl });
            // Create a map and a view
            const map = new Map({ basemap: 'streets-navigation-vector', layers: [featureLayer] });
            const view = new MapView({
                container: 'viewDiv', map: map, center: [-97.7431, 30.2672], // Longitude, latitude  
                zoom: 10
            });
            // Function to generate a token
            function generateToken(username, password) {
                return IdentityManager.generateToken({
                    server: 'https://gistest.twdb.texas.gov/portal/sharing/rest/generateToken', username: username, password: password
                }).then(credential => { return credential.token; });
            }
            // Function to add points using applyEdits
            function addPoints(token) {  // Define the points to be added  
                const adds = [{
                    attributes: {
                        Field1: 'Value1',
                        // Replace with your field names and values        
                        Field2: 'Value2'
                    }, geometry: {
                        type: "point", longitude: -97.7431, // Longitude        
                        latitude: 30.2672 // Latitude      
                    }
                },
                {
                    attributes: {
                        Field1: 'Value3',
                        Field2: 'Value4'
                    },
                    geometry: {
                        type: "point", longitude: -98.4936,
                        latitude: 29.4241
                    }
                }];
                // Apply the edits to the feature layer  
                featureLayer.applyEdits({
                    addFeatures: adds
                }, { token: token }).then(response => {
                    console.log('ApplyEdits Response:', response);
                }).catch(error => { console.error('Error:', error); });
            }
            // Main function to handle the process
            function main1() {
                const username = 'GISTest_Editor';
                // Replace with your username  
                const password = 'GISTest_Editor2024#';
                // Replace with your password
                generateToken(username, password).then(token => {
                    addPoints(token);
                }).catch(error => {
                    console.error('Failed to generate token or apply edits:', error);
                });
            }
            // Run the main function
            main1();
        });
    </script>
</body>

</html> -->




<!-- <!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://js.arcgis.com/4.23/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.23/"></script>
    <title>Add Data Points</title>
</head>

<body>
    <h1>Add Data Point Example</h1>
    <div id="viewDiv"></div>
    <script>

        // Define the URL of the feature service
        const url = 'https://gistest.twdb.texas.gov/server/rest/services/TxGIO_GIT/Dipak_Test_Collection_Rating/FeatureServer/0/applyEdits';

        // Define the points to be added
        const adds = [
            {
                attributes: {
                    Field1: 'Value1',  // Replace with your field names and values
                    Field2: 'Value2'
                },
                geometry: {
                    x: -97.7431,  // Longitude
                    y: 30.2672    // Latitude
                }
            },
            {
                attributes: {
                    Field1: 'Value3',
                    Field2: 'Value4'
                },
                geometry: {
                    x: -98.4936,
                    y: 29.4241
                }
            }
        ];

        // Create the payload for the applyEdits operation
        const payload = new URLSearchParams({
            f: 'json',
            adds: JSON.stringify(adds)
        });

        // Send the POST request
        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: payload
        })
            .then(response => response.json())
            .then(data => {
                // Handle the response from the server
                console.log(data);
            })
            .catch(error => {
                console.error('Error:', error);
            });

    </script>
</body>

</html> -->


<!DOCTYPE html>
<html lang="en">

<head>
    <title>Locate the user</title>
    <meta property="og:description"
        content="Geolocate the user and then track their current location on the map using the GeolocateControl." />
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='stylesheet' href='https://unpkg.com/maplibre-gl@4.3.2/dist/maplibre-gl.css' />
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src='https://unpkg.com/maplibre-gl@4.3.2/dist/maplibre-gl.js'></script>

</head>

<body>


    <div id="rChart" style="display:none; width: 400px; height: 400px;">
        <button id="closeChart">Hide</button>
        <canvas id="ratingsChart" style="width: 300px; height: 300px;"></canvas>
    </div>
    <div id="map">
        <div id="controls">
            <button id="startTracking">Start Tracking</button>
            <button id="stopTracking">Stop Tracking</button>
            <button id="showChart">Show Ratings Chart</button>
        </div>
    </div>

    <div id="locations">
        <h2>Location List</h2>
        <input type="text" id="searchBar" placeholder="Search by name, type, or rating...">
        <ul id="locationList"></ul>
        <!-- <table id="locationTable"></table> -->
    </div>

    <script src="https://unpkg.com/maplibre-gl@latest/dist/maplibre-gl.js"></script>
    <script src="https://unpkg.com/@turf/turf/turf.min.js"></script>
    <script src="https://js.arcgis.com/4.21/"></script>
    <script src="app.js"></script>
</body>

</html>